<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒªå¨ç¸®å½±äº’å‹•è¡Œç¨‹</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #fee2e2; /* Light red-100 background for a soft red theme */
        }
        .timeline-line {
            position: absolute;
            left: 2.5rem;
            top: 1rem;
            bottom: 1rem;
            width: 4px;
            background-color: #dc2626; /* Tailwind red-600 for the line */
            transform: translateX(-50%);
        }
        .timeline-item:last-child .timeline-line {
            display: none;
        }
        .tab-btn {
            transition: all 0.3s ease;
        }
        .tab-btn.active {
            background-color: #b91c1c; /* Tailwind red-700 for active tab */
            color: white;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .modal {
            transition: opacity 0.3s ease;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 120px;
            max-height: 200px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 150px;
            }
        }

        /* Fullscreen Map Modal Styles */
        #fullscreen-map-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        #fullscreen-map-modal.open {
            opacity: 1;
            visibility: visible;
        }

        #fullscreen-map-modal img {
            max-width: 90%;
            max-height: 90%;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1); /* shadow-xl */
        }

        #fullscreen-map-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            z-index: 1001;
        }
    </style>
</head>
<body class="text-gray-800">

    <div id="modal" class="modal fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 hidden opacity-0">
        <div class="bg-white rounded-2xl shadow-xl w-full max-w-md mx-auto transform transition-transform duration-300 scale-95">
            <div class="p-6 relative">
                <button id="modal-close-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-800 transition-colors">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
                </button>
                <h3 id="modal-title" class="text-2xl font-bold text-gray-900 mb-4"></h3>
                <div id="modal-content" class="text-gray-600 space-y-3"></div>
            </div>
        </div>
    </div>

    <!-- Fullscreen Map Modal -->
    <div id="fullscreen-map-modal">
        <button id="fullscreen-map-close-btn">&times;</button>
        <img id="fullscreen-map-image" src="" alt="æŒªå¨ç¸®å½±è·¯ç·šåœ– - å…¨è¢å¹•">
    </div>

    <div class="container mx-auto p-4 md:p-8 max-w-4xl">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-red-700">ğŸ‡³ğŸ‡´ æŒªå¨ç¸®å½±</h1>
            <p class="text-lg text-gray-600 mt-2">2025å¹´7æœˆ22æ—¥ - 7æœˆ23æ—¥ è©³ç´°è¡Œç¨‹</p>
        </header>

        <main>
            <div class="flex flex-wrap justify-center mb-8 space-x-2 md:space-x-4 bg-red-200 p-2 rounded-full">
                <button id="overview-btn" class="tab-btn w-full sm:w-auto text-lg font-bold py-3 px-4 rounded-full active">ç¸½è¦½</button>
                <button id="day1-btn" class="tab-btn w-full sm:w-auto text-lg font-bold py-3 px-4 rounded-full">ç¬¬ä¸€å¤© (7/22)</button>
                <button id="day2-btn" class="tab-btn w-full sm:w-auto text-lg font-bold py-3 px-4 rounded-full">ç¬¬äºŒå¤© (7/23)</button>
                <button id="activities-btn" class="tab-btn w-full sm:w-auto text-lg font-bold py-3 px-4 rounded-full">æ´»å‹•å»ºè­°</button>
            </div>

            <div id="overview-content" class="tab-content bg-white p-6 rounded-2xl shadow-lg mb-8">
                <h2 class="text-2xl font-bold text-center mb-4 text-gray-800">æ—…ç¨‹ç°¡ä»‹</h2>
                <p class="text-gray-700 leading-relaxed mb-6 text-center">
                    æ‚¨çš„ã€ŒæŒªå¨ç¸®å½±ã€(Sognefjord in a Nutshellâ„¢) ä¹‹æ—…å°‡æ–¼2025å¹´7æœˆ22æ—¥å±•é–‹ï¼Œé€™æ˜¯ä¸€è¶Ÿç²¾å¿ƒè¨­è¨ˆçš„è‡ªåŠ©å¼è¡Œç¨‹ï¼Œæ—¨åœ¨æä¾›ä¸€å ´å®å‰çš„å³½ç£æ¢éšªã€‚é€™è¶Ÿæ—…ç¨‹å·§å¦™åœ°çµåˆäº†å¤šç¨®äº¤é€šæ–¹å¼ï¼Œå¸¶æ‚¨æ·±å…¥é«”é©—æŒªå¨æœ€ä»¤äººå±æ¯çš„è‡ªç„¶é¢¨å…‰ã€‚
                    <br><br>
                    è¡Œç¨‹çš„æ ¸å¿ƒäº®é»åŒ…æ‹¬ï¼š
                    <br>
                    <ul>
                        <li><strong>å‘çˆ¾æ ¹éµè·¯ (Bergensbanen)ï¼š</strong> é€™æ¢å¸¸è¢«åœ‹å®¶åœ°ç†é›œèªŒè©•ç‚ºå…¨çƒæœ€ç²¾é‡‡çš„ç«è»Šæ—…ç¨‹ä¹‹ä¸€ï¼Œå°‡å¸¶æ‚¨ç©¿è¶Šå´å¶‡çš„å±±è„ˆã€é¬±é¬±è”¥è”¥çš„å±±è°·å’Œå¯§éœçš„å³½ç£ï¼Œå¾å¥§æ–¯é™¸èˆ’é©åœ°æŠµé”ç±³é”çˆ¾ï¼Œæ²¿é€”é¢¨æ™¯ä¸æ–·è®ŠåŒ–ï¼ŒåŒ…æ‹¬ç™½é›ªçššçššçš„å±±è„ˆå’Œæ­æ´²æœ€é«˜çš„é«˜åŸã€‚</li>
                        <li><strong>å¼—æ´›å§†éµè·¯ (FlÃ¥msbana)ï¼š</strong> é€™æ¢è¢«è­½ç‚ºä¸–ç•Œä¸Šæœ€ä»¤äººé›£ä»¥ç½®ä¿¡çš„éµè·¯æ—…ç¨‹ä¹‹ä¸€ï¼Œå°‡å¸¶æ‚¨å¾é«˜å±±è»Šç«™ç±³é”çˆ¾ (Myrdal) ä¸‹é™åˆ°å¼—æ´›å§† (FlÃ¥m)ã€‚æ²¿é€”æ‚¨å°‡ç›®ç¹å‚¾ç€‰è€Œä¸‹çš„ç€‘å¸ƒã€æ·±é‚ƒçš„å³½è°·å’Œç¹èŒ‚çš„æ™¯è§€ï¼Œæ„Ÿå—é€™æ¢å…¨çƒæœ€é™¡å³­éµè·¯ä¹‹ä¸€çš„å·¥ç¨‹å¥‡è¹Ÿã€‚</li>
                        <li><strong>æ¾æ©å³½ç£éŠèˆ¹ï¼š</strong> æ‚¨å°‡åœ¨æŒªå¨æœ€é•·ã€æœ€æ·±çš„å³½ç£ä¸Šäº«å—ä¸€æ®µå¯§éœè€Œå¦‚ç•«çš„éŠèˆ¹ä¹‹æ—…ï¼Œå…¶ä¸­åŒ…æ‹¬è¢«è¯åˆåœ‹æ•™ç§‘æ–‡çµ„ç¹”åˆ—ç‚ºä¸–ç•Œéºç”¢çš„è‰¾æ–¼è˜­å³½ç£ (Aurlandsfjord)ã€‚èˆ¹éš»å°‡åœ¨å…©å²¸é«˜è³çš„å±±è„ˆå’Œå¤æ¨¸çš„æ‘èŠä¹‹é–“æ»‘è¡Œï¼Œå‘ˆç¾ä»¤äººé›£å¿˜çš„æ°´ä¸Šæ™¯è‡´ã€‚</li>
                    </ul>
                    <br>
                    é€™è¶Ÿè‡ªåŠ©éŠç¨‹æä¾›äº†æ¥µå¤§çš„éˆæ´»æ€§ï¼Œè®“æ‚¨å¯ä»¥æ ¹æ“šå€‹äººå–œå¥½å¢åŠ æ´»å‹•æˆ–é¸æ“‡åœ¨è¿·äººçš„å·´å‹’æ–¯ç‰¹è˜­ (Balestrand) æ‘èŠéå¤œï¼Œè©²åœ°ä»¥å…¶å£¯è§€çš„æ™¯è‰²å’Œç¨ç‰¹çš„ã€Œé¾å¼ã€å»ºç¯‰é¢¨æ ¼è€Œèåã€‚æ•´å€‹è¡Œç¨‹åœ¨æ¯å¹´4æœˆ1æ—¥è‡³10æœˆ31æ—¥æœŸé–“é‹ç‡Ÿï¼Œç¢ºä¿æ‚¨åœ¨æœ€ä½³å­£ç¯€é«”é©—æŒªå¨çš„è‡ªç„¶å¥‡è§€ã€‚é€™å…©å¤©çš„æ—…ç¨‹å°‡ç‚ºå››åæˆäººå’Œå…©åå…’ç«¥çš„å®¶åº­åœ˜é«”å¸¶ä¾†ä¸€æ¬¡ç„¡ç¸«ä¸”è±å¯Œçš„æŒªå¨æ¢éšªï¼Œç•™ä¸‹å°æŒªå¨è¿·äººæ™¯è§€å’Œè±å¯Œæ–‡åŒ–éºç”¢çš„æŒä¹…è¨˜æ†¶ã€‚
                </p>
                <h2 class="text-2xl font-bold text-center mb-4 text-gray-800">è·¯ç·šæ¦‚è¦½åœ–</h2>
                <!-- Image for the route map that can be clicked to enlarge -->
                <div id="route-map-container" class="cursor-pointer overflow-hidden rounded-xl shadow-md mb-6 border border-gray-200">
                    <img id="route-map-thumbnail" src="https://cdn.sanity.io/images/4aans0in/production/661677de12b4359730baef1f8439af4aa32eb632-1312x697.svg?rect=37,0,1239,697&w=3840&h=2160&fm=webp&q=100&fit=max&auto=format"
                         alt="æŒªå¨ç¸®å½±è·¯ç·šåœ–" class="w-full h-auto object-cover rounded-xl"
                         onerror="this.onerror=null; this.src='https://placehold.co/800x400/FFCCCC/CC0000?text=åœ–ç‰‡è¼‰å…¥å¤±æ•—';">
                </div>
                <p class="text-sm text-gray-500 text-center mt-2">é»æ“Šåœ°åœ–æ”¾å¤§æŸ¥çœ‹è©³æƒ…ã€‚</p>

                <h2 class="text-2xl font-bold text-center mb-4 text-gray-800">æ—…ç¨‹æ™‚é–“åˆ†é…</h2>
                <div class="chart-container">
                    <canvas id="durationChart"></canvas>
                </div>
                <p class="text-sm text-gray-500 text-center mt-2">é€™å¼µåœ–è¡¨é¡¯ç¤ºäº†æ‚¨åœ¨å„æ®µäº¤é€šå·¥å…·ä¸Šæ‰€èŠ±è²»çš„æ™‚é–“æ¯”ä¾‹ï¼Œå¹«åŠ©æ‚¨å¿«é€Ÿäº†è§£æ—…ç¨‹çš„æ§‹æˆã€‚</p>
            </div>

            <div id="day1-content" class="tab-content bg-white p-6 rounded-2xl shadow-lg hidden relative">
                <h2 class="text-2xl font-bold text-center mb-6 text-gray-800">ç¬¬ä¸€å¤©è¡Œç¨‹æ¦‚è¦½ (7/22)</h2>
                <div class="timeline-line hidden md:block absolute left-[44px] top-24 bottom-6 w-[4px] bg-red-600 transform -translate-x-1/2 z-0"></div>
                <div class="space-y-12 relative pl-10 z-10 timeline-items-container">
                    <!-- Timeline items will be appended here -->
                </div>
            </div>

            <div id="day2-content" class="tab-content bg-white p-6 rounded-2xl shadow-lg hidden relative">
                <h2 class="text-2xl font-bold text-center mb-6 text-gray-800">ç¬¬äºŒå¤©è¡Œç¨‹æ¦‚è¦½ (7/23)</h2>
                <div class="timeline-line hidden md:block absolute left-[44px] top-24 bottom-6 w-[4px] bg-red-600 transform -translate-x-1/2 z-0"></div>
                <div class="space-y-12 relative pl-10 z-10 timeline-items-container">
                    <!-- Timeline items will be appended here -->
                </div>
            </div>

            <div id="activities-content" class="tab-content bg-white p-6 rounded-2xl shadow-lg hidden">
                <h2 class="text-2xl font-bold text-center mb-4 text-gray-800">æ´»å‹•å»ºè­°</h2>

                <section class="mb-8">
                    <h3 class="text-xl font-bold text-gray-900 mb-4">å¼—æ´›å§†æ´»å‹•å»ºè­°</h3>
                    <p class="text-gray-700 mb-3">
                        é‘‘æ–¼æ‚¨åœ¨å¼—æ´›å§†çš„åœç•™æ™‚é–“ç´„ç‚º2å°æ™‚26åˆ†é˜ï¼ˆä¸‹åˆ13:04æŠµé”ï¼Œä¸‹åˆ15:30å‡ºç™¼ï¼‰ï¼Œæ´»å‹•é¸æ“‡æ‡‰ç°¡çŸ­ä¸”æ˜“æ–¼å¾æ¸¯å£åˆ°é”ã€‚
                    </p>
                    <ul class="list-disc list-inside text-gray-700 space-y-2">
                        <li><strong>å¼·çƒˆæ¨è–¦ (ç°¡çŸ­ä¸”æ˜“æ–¼åˆ°é”)ï¼š</strong>
                            <ul class="list-disc list-inside ml-4">
                                <li>å¿«é€Ÿç”¨é¤/å°åƒï¼šåˆ©ç”¨é€™æ®µæ™‚é–“åœ¨å¼—æ´›å§†çš„å’–å•¡é¤¨æˆ–é¤å»³äº«ç”¨å¿«é€Ÿåˆé¤æˆ–å°åƒã€‚</li>
                                <li>æ¼«æ­¥å¼—æ´›å§†æ‘ï¼šæ¢ç´¢æ¸¯å£å‘¨é‚Šåœ°å€ï¼Œäº«å—å³½ç£æ°›åœã€‚</li>
                            </ul>
                        </li>
                        <li><strong>å¯èƒ½å¯è¡Œ (å¦‚æœæ™‚é–“å…è¨±ä¸”ç¯€å¥è‰¯å¥½)ï¼š</strong>
                            <ul class="list-disc list-inside ml-4">
                                <li>é›»å‹•å°å·´å‰å¾€æ–¯æ³°æ ¼æ–¯å¦è§€æ™¯å° (Stegastein Viewpoint)ï¼š1å°æ™‚30åˆ†é˜ï¼Œå¯å¾650å…¬å°ºé«˜è™•æ¬£è³è‰¾æ–¼è˜­å³½ç£çš„å£¯è§€å…¨æ™¯ã€‚</li>
                                <li>ç•¶åœ°ç¾é£Ÿå“åšï¼šç´„1å°æ™‚ã€‚</li>
                                <li>å¼—æ´›å§†å³½ç£æ¡‘æ‹¿ (Fjord Sauna in FlÃ¥m)ï¼š1å°æ™‚30åˆ†é˜ï¼Œæä¾›ç†±æ°£é¨°é¨°çš„æ¡‘æ‹¿æµ´å¾Œåœ¨å³½ç£ä¸­æ¸…çˆ½æµ¸æ³¡ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>ä¸å¯è¡Œ (ç”±æ–¼æ™‚é–“é™åˆ¶)ï¼š</strong>
                            <ul class="list-disc list-inside ml-4">
                                <li>çš®åˆ’è‰‡ (3å°æ™‚)ã€éºç”¢RIBå¿«è‰‡ä¹‹æ—… (2å°æ™‚15åˆ†é˜)ã€å¼—æ´›å§†é«˜ç©ºæ»‘ç´¢ (1-2å°æ™‚) æˆ–å„ç¨®å¾’æ­¥æ—…è¡Œ (2-8å°æ™‚)ã€‚é€™äº›æ´»å‹•éœ€è¦å»¶é•·åœ¨å¼—æ´›å§†çš„åœç•™æ™‚é–“ï¼Œä¸é©åˆæœ¬æ¬¡è¡Œç¨‹ã€‚</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section>
                    <h3 class="text-xl font-bold text-gray-900 mb-4">å·´å‹’æ–¯ç‰¹è˜­æ´»å‹•å»ºè­°</h3>
                    <p class="text-gray-700 mb-3">
                        æ‚¨å°‡æ–¼7æœˆ22æ—¥ä¸‹åˆ16:50æŠµé”å·´å‹’æ–¯ç‰¹è˜­ï¼Œä¸¦æ–¼7æœˆ23æ—¥æ—©ä¸Š07:50æ¸…æ™¨æ­ä¹˜æ¸¡è¼ªé›¢é–‹ã€‚å› æ­¤ï¼Œæ‰€æœ‰æ´»å‹•éƒ½å¿…é ˆå®‰æ’åœ¨ç¬¬ä¸€å¤©æ™šä¸Šé€²è¡Œã€‚
                    </p>
                    <ul class="list-disc list-inside text-gray-700 space-y-2">
                        <li><strong>å¼·çƒˆæ¨è–¦ (7æœˆ22æ—¥æ™šé–“)ï¼š</strong>
                            <ul class="list-disc list-inside ml-4">
                                <li>æ¢ç´¢å·´å‹’æ–¯ç‰¹è˜­æ‘å’Œè–å¥§æ‹‰å¤«æ•™å ‚ï¼šæ‚ é–’åœ°æ¼«æ­¥æ‘èŠï¼Œæ¬£è³å…¶è¿·äººçš„æœ¨å±‹å’Œç¨ç‰¹çš„è–å¥§æ‹‰å¤«æ•™å ‚ (å•Ÿç™¼è¿ªå£«å°¼é›»å½±ã€Šå†°é›ªå¥‡ç·£ã€‹)ã€‚</li>
                                <li>å³½ç£æ—æ™šé¤ï¼šåœ¨å·´å‹’æ–¯ç‰¹è˜­ç•¶åœ°é¤å»³äº«ç”¨æ™šé¤ï¼Œä¾‹å¦‚åœ¨æµ·æ¿±é¤å»³å“åšæ–°é®®æµ·é®®ã€‚</li>
                                <li>æ‚ é–’åœ°æ•£æ­¥ï¼šæ²¿è‘—å³½ç£é‚Šç·£çš„æ­¥é“æ•£æ­¥ï¼Œæ¬£è³æ—¥è½æˆ–äº«å—å¯§éœçš„å¤œæ™šã€‚</li>
                                <li>å®¶åº­éŠæˆ²æ™‚é–“/æ•…äº‹æœƒï¼šåœ¨æ‚¨çš„ä½å®¿åœ°é»ï¼Œäº«å—è¼•é¬†çš„å®¶åº­æ™‚å…‰ï¼Œç©éŠæˆ²æˆ–è¬›æ•…äº‹ã€‚</li>
                                <li>æ”å½±æ©Ÿæœƒï¼šåˆ©ç”¨å‚æ™šçš„æŸ”å’Œå…‰ç·šï¼Œæ•æ‰å·´å‹’æ–¯ç‰¹è˜­å’Œå³½ç£çš„ç¾æ™¯ã€‚</li>
                            </ul>
                        </li>
                        <li><strong>ä¸å¯è¡Œ (ç”±æ–¼æ™‚é–“é™åˆ¶)ï¼š</strong>
                            <ul class="list-disc list-inside ml-4">
                                <li>è¼ƒé•·æ™‚é–“çš„éŠè¦½ï¼Œä¾‹å¦‚å³½ç£èˆ‡å†°å·ä¹‹æ—… (4å°æ™‚30åˆ†é˜) æˆ–å…¨é¢çš„RIBå¿«è‰‡ä¹‹æ—… (1å°æ™‚30åˆ†é˜è‡³2å°æ™‚)ã€‚å‰å¾€å‹å¾·æ¢…å€«å±±ï¼ˆMt Raudmelenï¼‰çš„å°è¦½å¾’æ­¥æ—…è¡Œä¹Ÿé€šå¸¸æ˜¯è¼ƒé•·çš„æ´»å‹•ã€‚</li>
                            </ul>
                        </li>
                    </ul>
                </section>
            </div>

        </main>
        
        <footer class="text-center mt-12 text-sm text-gray-500">
            <p>ç¥æ‚¨æ—…é€”æ„‰å¿«ï¼</p>
        </footer>
    </div>

    <script>
        const itineraryData = {
            day1: [
                {
                    time: "06:20 - 11:15",
                    duration: "4å°æ™‚55åˆ†",
                    title: "ç«è»Šï¼šå¥§æ–¯é™¸ (Oslo S) â†’ ç±³é”çˆ¾ (Myrdal)",
                    icon: "ğŸš†",
                    bgColor: "bg-red-200", /* Light red for icon background */
                    textColor: "text-red-900", /* Dark red for icon text */
                    details: `
                        <p><strong>ç‡Ÿé‹å…¬å¸:</strong> Vy</p>
                        <p><strong>è»Šæ¬¡:</strong> F4 Bergen Track 4</p>
                        <p><strong>è»Šå»‚:</strong> 3è™Ÿè»Šå»‚ (å®¶åº­è»Šå»‚)</p>
                        <p><strong>åº§ä½:</strong> 25, 26, 29, 30, 31, 32</p>
                        <p class="mt-2 text-sm text-gray-500">å±•é–‹ä¸–ç•Œè‘—åçš„å‘çˆ¾æ ¹éµè·¯ä¹‹æ—…ï¼Œæ²¿é€”æ¬£è³æŒªå¨å£¯éº—çš„å±±è„ˆèˆ‡é«˜åŸæ™¯è§€ã€‚</p>
                    `
                },
                {
                    time: "12:06 - 13:04",
                    duration: "58åˆ†",
                    title: "ç«è»Šï¼šç±³é”çˆ¾ (Myrdal) â†’ å¼—æ´›å§† (FlÃ¥m)",
                    icon: "ğŸ›¤ï¸",
                    bgColor: "bg-blue-200", /* Light blue for icon background */
                    textColor: "text-blue-900", /* Dark blue for icon text */
                    details: `
                        <p><strong>ç‡Ÿé‹å…¬å¸:</strong> Vy</p>
                        <p><strong>è»Šæ¬¡:</strong> R45 FlÃ¥m Track 11</p>
                        <p><strong>åº§ä½:</strong> è‡ªç”±å…¥åº§ (å»ºè­°åç¬¬6è»Šå»‚)</p>
                        <p class="mt-2 text-sm text-gray-500">é«”é©—å…¨çƒæœ€é™¡å³­çš„éµè·¯ä¹‹ä¸€â€”â€”å¼—æ´›å§†éµè·¯ï¼Œæ¬£è³ä»¤äººå±æ¯çš„ç€‘å¸ƒèˆ‡å³½è°·ã€‚</p>
                    `
                },
                {
                    time: "15:30 - 16:50",
                    duration: "1å°æ™‚20åˆ†",
                    title: "æ¸¡è¼ªï¼šå¼—æ´›å§† (FlÃ¥m) â†’ å·´å‹’æ–¯ç‰¹è˜­ (Balestrand)",
                    icon: "ğŸš¢",
                    bgColor: "bg-red-200", /* Light red for icon background */
                    textColor: "text-red-900", /* Dark red for icon text */
                    details: `
                        <p><strong>ç‡Ÿé‹å…¬å¸:</strong> Norled</p>
                        <p><strong>é è¨‚ç·¨è™Ÿ:</strong> 1327133235</p>
                        <p><strong>è·¯ç·š:</strong> FlÃ¥m kai - Balestrand kai</p>
                        <p class="mt-2 text-sm text-gray-500">æ­ä¹˜æ¸¡è¼ªç©¿è¶Šå£¯éº—çš„æ¾æ©å³½ç£ï¼Œæ—…ç¨‹å°‡ç¶“éè¢«è¯åˆåœ‹æ•™ç§‘æ–‡çµ„ç¹”åˆ—ç‚ºä¸–ç•Œéºç”¢çš„è‰¾æ–¼è˜­å³½ç£ï¼Œç„¶å¾Œæ²¿è‘—æŒªå¨æœ€é•·ã€æœ€æ·±çš„æ¾æ©å³½ç£å‰è¡Œã€‚</p>
                    `
                },
                {
                    time: "16:50 ä»¥å¾Œ",
                    duration: "",
                    title: "æŠµé” & å…¥ä½å·´å‹’æ–¯ç‰¹è˜­",
                    icon: "ğŸ¨",
                    bgColor: "bg-blue-200", /* Light blue for icon background */
                    textColor: "text-blue-900", /* Dark blue for icon text */
                    details: `
                        <p><strong>ä½å®¿åœ°å€:</strong> Kaivegen 4, Balestrand kommune, Sogn og Fjordane 6899, æŒªå¨</p>
                        <p><strong>å…¥ä½æ™‚é–“:</strong> 2025å¹´7æœˆ22æ—¥ (é€±äºŒ) ä¸‹åˆ 3:00</p>
                        <p><strong>å…¥ä½æ–¹å¼:</strong> å¯†ç¢¼é‘°åŒ™ç›’ (è©³æƒ…è«‹èˆ‡æˆ¿æ±ç¢ºèª)</p>
                        <p><strong>å…¥ä½äººæ•¸:</strong> 4ä½æˆäºº, 2ä½å…’ç«¥</p>
                        <p class="mt-2 text-sm text-gray-500">åœ¨é¢¨æ™¯å¦‚ç•«çš„å³½ç£å°é®å·´å‹’æ–¯ç‰¹è˜­å®‰é “ä¸‹ä¾†ï¼Œæº–å‚™äº«å—å¯§éœçš„å¤œæ™šã€‚</p>
                    `
                }
            ],
            day2: [
                 {
                    time: "07:50 ä¹‹å‰",
                    duration: "",
                    title: "é€€æˆ¿æº–å‚™",
                    icon: "ğŸ§³",
                    bgColor: "bg-red-200", /* Light red for icon background */
                    textColor: "text-red-900", /* Dark red for icon text */
                    details: `
                        <p><strong>é€€æˆ¿æ™‚é–“:</strong> 2025å¹´7æœˆ23æ—¥ (é€±ä¸‰) ä¸Šåˆ 11:00</p>
                        <p class="mt-2 text-sm text-gray-500">é›–ç„¶é€€æˆ¿æ™‚é–“æ˜¯11:00ï¼Œä½†ç‚ºäº†è¶•ä¸Š07:50çš„æ¸¡è¼ªï¼Œè«‹å‹™å¿…ææ—©æº–å‚™å¥½è¡Œæä¸¦è¾¦ç†é›¢å®¿æ‰‹çºŒã€‚</p>
                    `
                },
                {
                    time: "07:50 - 11:50",
                    duration: "4å°æ™‚",
                    title: "æ¸¡è¼ªï¼šå·´å‹’æ–¯ç‰¹è˜­ (Balestrand) â†’ å‘çˆ¾æ ¹ (Bergen)",
                    icon: "ğŸš¢",
                    bgColor: "bg-blue-200", /* Light blue for icon background */
                    textColor: "text-blue-900", /* Dark blue for icon text */
                    details: `
                        <p><strong>ç‡Ÿé‹å…¬å¸:</strong> Norled</p>
                        <p><strong>é è¨‚ç·¨è™Ÿ:</strong> 1998221682</p>
                        <p><strong>è·¯ç·š:</strong> Balestrand kai - Bergen Strandkaiterminal</p>
                        <p class="mt-2 text-sm text-gray-500">ç¹¼çºŒæ‚¨åœ¨å£¯éº—çš„æ¾æ©å³½ç£ä¸Šçš„å·¡éŠï¼Œé§›å‘æ—…ç¨‹çš„çµ‚é»â€”â€”è¿·äººçš„æ¸¯å£åŸå¸‚å‘çˆ¾æ ¹ã€‚</p>
                    `
                },
                {
                    time: "11:50",
                    duration: "",
                    title: "æŠµé”å‘çˆ¾æ ¹ï¼Œé–‹å§‹å¦ä¸€æ®µæ—…ç¨‹",
                    icon: "ğŸ",
                    bgColor: "bg-gray-100", /* Neutral ending color, keeping consistent with previous neutral */
                    textColor: "text-gray-800",
                    details: `
                        <p>æ­¡è¿ä¾†åˆ°å‘çˆ¾æ ¹ï¼æ‚¨çš„ã€ŒæŒªå¨ç¸®å½±ã€è¡Œç¨‹åœ¨æ­¤åœ“æ»¿çµæŸï¼Œä½†ä¹Ÿæ˜¯æ‚¨æ¢ç´¢é€™åº§ç¾éº—åŸå¸‚çš„é–‹å§‹ã€‚</p>
                        <p class="mt-2 text-sm text-gray-500">å»ºè­°æ‚¨å¯ä»¥å¤šåœç•™ä¸€å…©å¤©ï¼Œæ¢ç´¢é€™åº§è¢«åˆ—ç‚ºä¸–ç•Œéºç”¢çš„ç¾éº—åŸå¸‚ï¼Œç‰¹åˆ¥æ˜¯å¸ƒå‘‚æ ¹ç¢¼é ­ã€‚</p>
                    `
                }
            ]
        };

        const overviewBtn = document.getElementById('overview-btn');
        const day1Btn = document.getElementById('day1-btn');
        const day2Btn = document.getElementById('day2-btn');
        const activitiesBtn = document.getElementById('activities-btn');

        const overviewContent = document.getElementById('overview-content');
        const day1Content = document.getElementById('day1-content');
        const day2Content = document.getElementById('day2-content');
        const activitiesContent = document.getElementById('activities-content');

        const modal = document.getElementById('modal');
        const modalTitle = document.getElementById('modal-title');
        const modalContent = document.getElementById('modal-content');
        const modalCloseBtn = document.getElementById('modal-close-btn');

        const fullscreenMapModal = document.getElementById('fullscreen-map-modal');
        const fullscreenMapImage = document.getElementById('fullscreen-map-image');
        const fullscreenMapCloseBtn = document.getElementById('fullscreen-map-close-btn');
        const routeMapThumbnail = document.getElementById('route-map-thumbnail');
        const routeMapContainer = document.getElementById('route-map-container');


        let durationChartInstance = null;

        function createTimelineItem(item) {
            const itemDiv = document.createElement('div');
            itemDiv.className = 'timeline-item relative flex items-start group cursor-pointer';

            const iconContainer = document.createElement('div');
            iconContainer.className = `flex-shrink-0 w-20 h-20 rounded-full ${item.bgColor} flex items-center justify-center text-4xl shadow-md border-4 border-white transform group-hover:scale-110 transition-transform`;
            iconContainer.textContent = item.icon;

            const contentDiv = document.createElement('div');
            contentDiv.className = 'ml-6 bg-white p-6 rounded-2xl shadow-lg flex-grow';
            
            const timeP = document.createElement('p');
            timeP.className = `font-bold text-lg ${item.textColor}`;
            timeP.textContent = item.time;

            const titleH4 = document.createElement('h4');
            titleH4.className = 'text-xl font-bold text-gray-900 mt-1';
            titleH4.textContent = item.title;
            
            const durationP = document.createElement('p');
            durationP.className = 'text-sm text-gray-500 mt-1';
            durationP.textContent = item.duration;

            const ctaP = document.createElement('p');
            ctaP.className = 'text-sm font-semibold text-blue-600 mt-3 group-hover:underline';
            ctaP.textContent = 'æŸ¥çœ‹è©³æƒ… â†’';

            contentDiv.appendChild(timeP);
            contentDiv.appendChild(titleH4);
            if(item.duration) contentDiv.appendChild(durationP);
            contentDiv.appendChild(ctaP);

            itemDiv.appendChild(iconContainer);
            itemDiv.appendChild(contentDiv);
            
            itemDiv.addEventListener('click', () => {
                modalTitle.textContent = `${item.icon} ${item.title}`;
                modalContent.innerHTML = item.details;
                modal.classList.remove('hidden');
                setTimeout(()=> modal.classList.remove('opacity-0'), 10);
                setTimeout(()=> modal.querySelector('div').classList.remove('scale-95'), 10);
            });
            return itemDiv;
        }
        
        function populateTimeline(day, container) {
            const timelineItemsWrapper = container.querySelector('.timeline-items-container');
            timelineItemsWrapper.innerHTML = '';
            itineraryData[day].forEach(item => {
                timelineItemsWrapper.appendChild(createTimelineItem(item));
            });
        }

        function switchTab(activeTabId) {
            const tabs = [overviewBtn, day1Btn, day2Btn, activitiesBtn];
            const contents = [overviewContent, day1Content, day2Content, activitiesContent];

            tabs.forEach(btn => btn.classList.remove('active'));
            contents.forEach(content => content.classList.add('hidden'));

            if (activeTabId === 'overview') {
                overviewBtn.classList.add('active');
                overviewContent.classList.remove('hidden');
            } else if (activeTabId === 'day1') {
                day1Btn.classList.add('active');
                day1Content.classList.remove('hidden');
            } else if (activeTabId === 'day2') {
                day2Btn.classList.add('active');
                day2Content.classList.remove('hidden');
            } else if (activeTabId === 'activities') {
                activitiesBtn.classList.add('active');
                activitiesContent.classList.remove('hidden');
            }

            // Hide/show timeline-line based on tab
            day1Content.querySelector('.timeline-line').classList.toggle('hidden', activeTabId !== 'day1');
            day2Content.querySelector('.timeline-line').classList.toggle('hidden', activeTabId !== 'day2');

            if (activeTabId === 'overview' && durationChartInstance) {
                durationChartInstance.resize();
            }
        }

        overviewBtn.addEventListener('click', () => switchTab('overview'));
        day1Btn.addEventListener('click', () => switchTab('day1'));
        day2Btn.addEventListener('click', () => switchTab('day2'));
        activitiesBtn.addEventListener('click', () => switchTab('activities'));

        modalCloseBtn.addEventListener('click', () => {
             modal.classList.add('opacity-0');
             modal.querySelector('div').classList.add('scale-95');
             setTimeout(()=> modal.classList.add('hidden'), 300);
        });
        
        modal.addEventListener('click', (e) => {
            if(e.target === modal) {
                modalCloseBtn.click();
            }
        });

        // Fullscreen map logic
        routeMapContainer.addEventListener('click', () => {
            fullscreenMapImage.src = routeMapThumbnail.src; // Set the full image source
            fullscreenMapModal.classList.add('open');
        });

        fullscreenMapCloseBtn.addEventListener('click', () => {
            fullscreenMapModal.classList.remove('open');
        });

        fullscreenMapModal.addEventListener('click', (e) => {
            if (e.target === fullscreenMapModal || e.target === fullscreenMapImage) { // Allow clicking image to close too
                fullscreenMapModal.classList.remove('open');
            }
        });


        document.addEventListener('DOMContentLoaded', () => {
            populateTimeline('day1', day1Content);
            populateTimeline('day2', day2Content);
            
            const ctx = document.getElementById('durationChart').getContext('2d');
            
            const parseDuration = (durationStr) => {
                if (!durationStr) return 0;
                let totalMinutes = 0;
                // Regex to correctly capture hours and minutes even if only one is present
                const hoursMatch = durationStr.match(/(\d+)\s*å°æ™‚/);
                const minutesMatch = durationStr.match(/(\d+)\s*åˆ†/);

                if(hoursMatch && hoursMatch[1]) {
                    totalMinutes += parseInt(hoursMatch[1]) * 60;
                }
                if(minutesMatch && minutesMatch[1]) {
                    totalMinutes += parseInt(minutesMatch[1]);
                }
                return totalMinutes;
            };
            
            const durations = [
                parseDuration(itineraryData.day1[0].duration),
                parseDuration(itineraryData.day1[1].duration),
                parseDuration(itineraryData.day1[2].duration),
                parseDuration(itineraryData.day2[1].duration)
            ];

            durationChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['æ—…ç¨‹ç¸½è¦½'],
                    datasets: [
                        {
                            label: 'ç«è»Š (Oslo â†’ Myrdal)',
                            data: [durations[0]],
                            backgroundColor: 'rgba(220, 38, 38, 0.8)', /* Red 600 */
                            borderColor: 'rgba(220, 38, 38, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'ç«è»Š (Myrdal â†’ FlÃ¥m)',
                            data: [durations[1]],
                            backgroundColor: 'rgba(30, 64, 175, 0.8)', /* Blue 800 */
                            borderColor: 'rgba(30, 64, 175, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'æ¸¡è¼ª (FlÃ¥m â†’ Balestrand)',
                            data: [durations[2]],
                            backgroundColor: 'rgba(153, 27, 27, 0.8)', /* Red 800 */
                            borderColor: 'rgba(153, 27, 27, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'æ¸¡è¼ª (Balestrand â†’ Bergen)',
                            data: [durations[3]],
                            backgroundColor: 'rgba(96, 165, 250, 0.8)', /* Blue 400 */
                            borderColor: 'rgba(96, 165, 250, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        title: { display: false },
                        legend: { position: 'bottom', labels: { boxWidth: 20, padding: 20 } },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.x !== null) {
                                        const hours = Math.floor(context.parsed.x / 60);
                                        const minutes = context.parsed.x % 60;
                                        label += `${hours} å°æ™‚ ${minutes} åˆ†`;
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            stacked: true,
                            display: false,
                        },
                        y: {
                            stacked: true,
                            display: false,
                        }
                    },
                    layout: {
                        padding: {
                            top: 5, bottom: 5, left: 10, right: 10
                        }
                    }
                }
            });
            switchTab('overview');
        });
    </script>
</body>
</html>
